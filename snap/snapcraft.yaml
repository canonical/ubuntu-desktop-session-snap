name: ubuntu-desktop-session
adopt-info: ubuntu-desktop-session
build-base: core22
base: core22
passthrough:
  base: core22-desktop
summary: Ubuntu Desktop Session for the Ubuntu Core Desktop
description: |
  A strictly confined Ubuntu Desktop session for Ubuntu Core Desktop.

grade: stable
confinement: strict
architectures:
- amd64
- arm64

package-repositories:
  - type: apt
    ppa: desktop-snappers/core-desktop

layout:
  /usr/share/xml/iso-codes:
    bind: $SNAP/gnome-platform/usr/share/xml/iso-codes
  /usr/share/libdrm:
    bind: $SNAP/gnome-platform/usr/share/libdrm
  /usr/share/gnome-shell:
    bind: $SNAP/usr/share/gnome-shell

environment:
  HOME: $SNAP_REAL_HOME
  XDG_CACHE_HOME: $SNAP_USER_COMMON/.cache
  XDG_CONFIG_HOME: $SNAP_USER_COMMON/.config
  XDG_DATA_HOME: $SNAP_USER_COMMON/.local/share

apps:
  ubuntu-desktop-session:
    command: run-session.sh
    slots:
      - wayland
      - x11
    plugs:
      - account-control
      - locale-control
      - time-control
      - timeserver-control
      - timezone-control
      - shell-session-locale-files

  pipewire:
    command: run.sh /usr/bin/pipewire
    daemon: simple
    sockets:
      pipewire:
        listen-stream: $XDG_RUNTIME_DIR/pipewire-0
    passthrough:
      daemon-scope: user
    plugs:
      - alsa
    before:
      - wireplumber

  pipewire-pulse:
    command: run.sh /usr/bin/pipewire-pulse
    daemon: simple
    sockets:
      pulse:
        listen-stream: $XDG_RUNTIME_DIR/pulse/native
    passthrough:
      daemon-scope: user
    plugs:
      - alsa

  wireplumber:
    command: run.sh /usr/bin/wireplumber
    daemon: simple
    passthrough:
      daemon-scope: user
    after:
      - pipewire
    plugs:
      - alsa

  gnome-terminal-server:
    command: run.sh /usr/libexec/gnome-terminal-server
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-gnome-terminal

  screencast-service:
    command: run.sh /usr/bin/gjs /usr/share/gnome-shell/org.gnome.Shell.Screencast
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-gnome-shell-screencast

  nautilus-service:
    command: run.sh /usr/bin/nautilus --gapplication-service
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-gnome-nautilus

  xdg-desktop-portal-gnome:
    command: run.sh /usr/libexec/xdg-desktop-portal-gnome
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-freedesktop-impl-portal-gnome

  xdg-desktop-portal-gtk:
    command: run.sh /usr/libexec/xdg-desktop-portal-gtk
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-freedesktop-impl-portal-gtk

  ibus-service:
    command: run.sh /usr/bin/ibus-daemon --panel disable
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-ibus

  ibus-gtk3-service:
    command: run.sh /usr/libexec/ibus-extension-gtk3
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-ibus-gtk3

  ibus-portal-service:
    command: run.sh /usr/libexec/ibus-portal
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-ibus-portal

  colord:
    command: run.sh /usr/libexec/colord-session
    daemon: dbus
    passthrough:
      daemon-scope: user
      activates-on:
        - dbus-colord

plugs:
  gtk-3-themes:
    interface: content
    target: $SNAP/data-dir/themes
    default-provider: gtk-common-themes
  icon-themes:
    interface: content
    target: $SNAP/data-dir/icons
    default-provider: gtk-common-themes
  sound-themes:
    interface: content
    target: $SNAP/data-dir/sounds
    default-provider: gtk-common-themes
  gnome-42-2204:
    interface: content
    target: $SNAP/gnome-platform
    default-provider: gnome-42-2204

  avahi-control: null
  bluez: null
  bluetooth-control: null
  cups-control: null
  desktop-launch: null
  dot-local-share-nautilus:
    interface: personal-files
    write:
      - $HOME/.local/share/nautilus
  dot-hidden:
    interface: personal-files
    write:
      - $HOME/.hidden
  hardware-observe: null
  hostname-control: null
  home: null
  login-session-observe: null
  login-session-control: null
  mount-observe: null
  network-bind: null
  network-control: null
  network-observe: null
  network-manager: null
  opengl: null
  polkit-agent: null
  process-control: null
  shutdown: null
  ssh-keys: null
  system-observe: null
  shell-session-locale-files:
    interface: personal-files
    write:
      - $HOME/.pam_environment
      - $HOME/.xinputrc
  shell-config-files:
    interface: system-files
    read:
      - /etc/fonts
      - /etc/glvnd
      - /etc/gnome/defaults.list
      - /etc/gtk-3.0
      - /etc/pulse
      - /etc/shells
      - /etc/xdg/autostart
      - /run/udev/tags/seat
      - /etc/default/im-config
      - /etc/X11/xinit/xinputrc
      - /etc/default/locale
  upower-observe: null

slots:
  audio-playback: null
  audio-record: null
  pulseaudio: null
  desktop: null
  dbus-canonical-unity:
    interface: dbus
    bus: session
    name: com.canonical.Unity
  dbus-freedesktop-impl-portal-gnome:
    interface: dbus
    bus: session
    name: org.freedesktop.impl.portal.desktop.gnome
  dbus-freedesktop-impl-portal-gtk:
    interface: dbus
    bus: session
    name: org.freedesktop.impl.portal.desktop.gtk
  dbus-freedesktop-screensaver:
    interface: dbus
    bus: session
    name: org.freedesktop.ScreenSaver
  dbus-freedesktop-secrets:
    interface: dbus
    bus: session
    name: org.freedesktop.secrets
  dbus-gnome-cc:
    interface: dbus
    bus: session
    name: org.gnome.ControlCenter
  dbus-gnome-cc-search:
    interface: dbus
    bus: session
    name: org.gnome.ControlCenter.SearchProvider
  dbus-gnome-keyring:
    interface: dbus
    bus: session
    name: org.gnome.keyring
  dbus-gnome-keyring-sysprompter:
    interface: dbus
    bus: session
    name: org.gnome.keyring.SystemPrompter
  dbus-gnome-magnifier:
    interface: dbus
    bus: session
    name: org.gnome.Magnifier
  dbus-gnome-mutter-displayconfig:
    interface: dbus
    bus: session
    name: org.gnome.Mutter.DisplayConfig
  dbus-gnome-mutter-idlemonitor:
    interface: dbus
    bus: session
    name: org.gnome.Mutter.IdleMonitor
  dbus-gnome-mutter-remotedesktop:
    interface: dbus
    bus: session
    name: org.gnome.Mutter.RemoteDesktop
  dbus-gnome-mutter-screencast:
    interface: dbus
    bus: session
    name: org.gnome.Mutter.ScreenCast
  dbus-gnome-panel:
    interface: dbus
    bus: session
    name: org.gnome.Panel
  dbus-gnome-screensaver:
    interface: dbus
    bus: session
    name: org.gnome.ScreenSaver
  dbus-gnome-sessionmanager:
    interface: dbus
    bus: session
    name: org.gnome.SessionManager
  dbus-gsd:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon
  dbus-gsd-a11ysettings:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.A11ySettings
  dbus-gsd-color:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Color
  dbus-gsd-datetime:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Datetime
  dbus-gsd-housekeeping:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Housekeeping
  dbus-gsd-keyboard:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Keyboard
  dbus-gsd-mediakeys:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.MediaKeys
  dbus-gsd-power:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Power
  dbus-gsd-printnotifications:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.PrintNotifications
  dbus-gsd-rfkill:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Rfkill
  dbus-gsd-screensaverproxy:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.ScreensaverProxy
  dbus-gsd-sharing:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Sharing
  dbus-gsd-smartcard:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Smartcard
  dbus-gsd-sound:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Sound
  dbus-gsd-usbprotection:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.UsbProtection
  dbus-gsd-wacom:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Wacom
  dbus-gsd-wwan:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.Wwan
  dbus-gsd-xsettings:
    interface: dbus
    bus: session
    name: org.gnome.SettingsDaemon.XSettings
  dbus-gnome-nautilus:
    interface: dbus
    bus: session
    name: org.gnome.Nautilus
  dbus-gnome-shell:
    interface: dbus
    bus: session
    name: org.gnome.Shell
  dbus-gnome-shell-audio:
    interface: dbus
    bus: session
    name: org.gnome.Shell.AudioDeviceSelection
  dbus-gnome-shell-introspect:
    interface: dbus
    bus: session
    name: org.gnome.Shell.Introspect
  dbus-gnome-shell-portal:
    interface: dbus
    bus: session
    name: org.gnome.Shell.Portal
  dbus-gnome-shell-screencast:
    interface: dbus
    bus: session
    name: org.gnome.Shell.Screencast
  dbus-gnome-shell-screenshot:
    interface: dbus
    bus: session
    name: org.gnome.Shell.Screenshot
  dbus-gnome-shell-wacom:
    interface: dbus
    bus: session
    name: org.gnome.Shell.Wacom.PadOsd
  dbus-gnome-terminal:
    interface: dbus
    bus: session
    name: org.gnome.Terminal
  dbus-gtk-mountoperationhandler:
    interface: dbus
    bus: session
    name: org.gtk.MountOperationHandler
  dbus-gtk-notifications:
    interface: dbus
    bus: session
    name: org.gtk.Notifications
  dbus-gtk-settings:
    interface: dbus
    bus: session
    name: org.gtk.Settings
  dbus-kde-statusnotifier:
    interface: dbus
    bus: session
    name: org.kde.StatusNotifierWatcher
  dbus-desktop-icons:
    interface: dbus
    bus: session
    name: com.rastersoft.ding
  dbus-desktop-icons-extension:
    interface: dbus
    bus: session
    name: com.rastersoft.dingextension
  dbus-pulseaudio-server:
    interface: dbus
    bus: session
    name: org.pulseaudio.Server
  dbus-portal:
    interface: dbus
    name: org.freedesktop.impl.portal.PermissionStore
    bus: session
  dbus-wireplumber:
    interface: dbus
    name: org.freedesktop.ReserveDevice1
    bus: session
  dbus-ibus:
    interface: dbus
    name: org.freedesktop.IBus
    bus: session
  dbus-ibus-gtk3:
    interface: dbus
    name: org.freedesktop.IBus.Panel.Extension.Gtk3
    bus: session
  dbus-ibus-portal:
    interface: dbus
    name: org.freedesktop.portal.IBus
    bus: session
  dbus-colord:
    interface: dbus
    name: org.freedesktop.ColorHelper
    bus: session

parts:
  scripts:
    plugin: dump
    source: ./scripts
  ubuntu-desktop-session:
    plugin: nil
    build-packages:
      - git
    override-build: |
      cd $SNAPCRAFT_PROJECT_DIR
      craftctl set version=$(date +%Y%m%d)+git$(git rev-parse --short HEAD)

  ninja:
    plugin: nil
    source: https://github.com/ninja-build/ninja.git
    source-tag: 'v1.11.1'
    override-build: |
      rm -rf build
      rm -f ninja
      rm -f ninja_bootstrap
      sed -i 's_^#!/usr/bin/env python$_#!/usr/bin/env python3_g' configure.py
      ./configure.py --bootstrap
      mv ninja ninja_bootstrap
      rm -rf build
      ./ninja_bootstrap
      rm -f ninja_bootstrap
      mkdir -p $CRAFT_PART_INSTALL/usr/bin
      mv ninja $CRAFT_PART_INSTALL/usr/bin/
    build-packages:
      - python3

  meson-deps:
    after: [ ninja ]
    plugin: nil
    source: https://github.com/mesonbuild/meson.git
    source-tag: '1.1.0'
    override-build: |
      python3 -m pip install .
      mkdir -p $CRAFT_PART_INSTALL/usr/lib/python3/dist-packages
      rm -rf $CRAFT_PART_INSTALL/usr/lib/python3/dist-packages/meson*
      python3 -m pip install --target=$CRAFT_PART_INSTALL/usr .
      mv $CRAFT_PART_INSTALL/usr/meson* $CRAFT_PART_INSTALL/usr/lib/python3/dist-packages/
      sed -i "s%^#!/usr/bin/python3$%#!/usr/bin/env python3%g" /usr/local/bin/meson
      sed -i "s%^#!/usr/bin/python3$%#!/usr/bin/env python3%g" $CRAFT_PART_INSTALL/usr/bin/meson
    build-packages:
      - python3-pip

  libei:
    after: [ meson-deps ]
    source: https://gitlab.freedesktop.org/libinput/libei.git
    source-tag: '1.0.901'
    source-depth: 1
    plugin: meson
    meson-parameters:
      - --prefix=/usr
      - -Doptimization=3
      - -Ddebug=true
      - -Dauto_features=enabled
      - -Dsd-bus-provider=libsystemd
    build-environment:
      - PATH: /snap/gnome-42-2204-sdk/current/usr/bin${PATH:+:$PATH}
      - XDG_DATA_DIRS: $SNAPCRAFT_STAGE/usr/share:/snap/gnome-42-2204-sdk/current/usr/share:/usr/share${XDG_DATA_DIRS:+:$XDG_DATA_DIRS}
      - LD_LIBRARY_PATH: /snap/gnome-42-2204-sdk/current/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib:/snap/gnome-42-2204-sdk/current/usr/lib/vala-current:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pulseaudio${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}
      - PKG_CONFIG_PATH: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/lib/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/share/pkgconfig${PKG_CONFIG_PATH:+:$PKG_CONFIG_PATH}
      - GETTEXTDATADIRS: /snap/gnome-42-2204-sdk/current/usr/share/gettext-current${GETTEXTDATADIRS:+:$GETTEXTDATADIRS}
      - GDK_PIXBUF_MODULE_FILE: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gdk-pixbuf-current/loaders.cache
      - ACLOCAL_PATH: /snap/gnome-42-2204-sdk/current/usr/share/aclocal${ACLOCAL_PATH:+:$ACLOCAL_PATH}
      - PYTHONPATH: /snap/gnome-42-2204-sdk/current/usr/lib/python3.10:/snap/gnome-42-2204-sdk/current/usr/lib/python3/dist-packages:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gobject-introspection:/usr/lib/python3/dist-packages:${PYTHONPATH:+:$PYTHONPATH}
    build-packages:
      - libsystemd-dev
      - libevdev-dev
      - python3-attr
      - python3-jinja2
      - python3-pytest
      - python3-structlog
      - python3-dbusmock
    override-pull: |
      craftctl default
      python3 -m pip install strenum

  libmutter:
    after: [ meson-deps, libei ]
    source: https://salsa.debian.org/gnome-team/mutter.git
    source-tag: 'ubuntu/45.0-2ubuntu1'
    plugin: meson
    meson-parameters:
      - --prefix=/usr
      - -Doptimization=3
      - -Ddebug=true
      - -Dintrospection=true
      - -Dtests=false
      - -Dinstalled_tests=false
      - -Dprofiler=false
    build-environment:
      - PATH: /snap/gnome-42-2204-sdk/current/usr/bin${PATH:+:$PATH}
      - XDG_DATA_DIRS: $SNAPCRAFT_STAGE/usr/share:/snap/gnome-42-2204-sdk/current/usr/share:/usr/share${XDG_DATA_DIRS:+:$XDG_DATA_DIRS}
      - LD_LIBRARY_PATH: /snap/gnome-42-2204-sdk/current/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib:/snap/gnome-42-2204-sdk/current/usr/lib/vala-current:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pulseaudio${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}
      - PKG_CONFIG_PATH: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/lib/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/share/pkgconfig${PKG_CONFIG_PATH:+:$PKG_CONFIG_PATH}
      - GETTEXTDATADIRS: /snap/gnome-42-2204-sdk/current/usr/share/gettext-current${GETTEXTDATADIRS:+:$GETTEXTDATADIRS}
      - GDK_PIXBUF_MODULE_FILE: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gdk-pixbuf-current/loaders.cache
      - ACLOCAL_PATH: /snap/gnome-42-2204-sdk/current/usr/share/aclocal${ACLOCAL_PATH:+:$ACLOCAL_PATH}
      - PYTHONPATH: /snap/gnome-42-2204-sdk/current/usr/lib/python3.10:/snap/gnome-42-2204-sdk/current/usr/lib/python3/dist-packages:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gobject-introspection${PYTHONPATH:+:$PYTHONPATH}
      - CFLAGS: -Wno-error=redundant-decls -Wno-error=format-nonliteral
    build-snaps: [ gnome-42-2204-sdk ]
    build-packages:
      - quilt
      - libcolord-dev
      - libxkbfile-dev
      - libxkbcommon-x11-dev
      - libxcb-randr0-dev
      - libxcb-res0-dev
      - libstartup-notification0-dev
      - libpipewire-0.3-dev
      - xwayland
      - xcvt
    override-pull: |
      craftctl default
      QUILT_PATCHES=debian/patches quilt push -a

  gcr:
    after: [ meson-deps ]
    source: https://gitlab.gnome.org/GNOME/gcr.git
    source-tag: '4.1.0'
    plugin: meson
    meson-parameters:
      - --prefix=/usr
      - -Doptimization=3
      - -Ddebug=true
      - -Dintrospection=true
      - -Dgtk_doc=false
    build-environment:
      - PATH: /snap/gnome-42-2204-sdk/current/usr/bin${PATH:+:$PATH}
      - XDG_DATA_DIRS: $SNAPCRAFT_STAGE/usr/share:/snap/gnome-42-2204-sdk/current/usr/share:/usr/share${XDG_DATA_DIRS:+:$XDG_DATA_DIRS}
      - LD_LIBRARY_PATH: /snap/gnome-42-2204-sdk/current/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib:/snap/gnome-42-2204-sdk/current/usr/lib/vala-current:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pulseaudio${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}
      - PKG_CONFIG_PATH: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/lib/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/share/pkgconfig${PKG_CONFIG_PATH:+:$PKG_CONFIG_PATH}
      - GETTEXTDATADIRS: /snap/gnome-42-2204-sdk/current/usr/share/gettext-current${GETTEXTDATADIRS:+:$GETTEXTDATADIRS}
      - GDK_PIXBUF_MODULE_FILE: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gdk-pixbuf-current/loaders.cache
      - ACLOCAL_PATH: /snap/gnome-42-2204-sdk/current/usr/share/aclocal${ACLOCAL_PATH:+:$ACLOCAL_PATH}
      - PYTHONPATH: /snap/gnome-42-2204-sdk/current/usr/lib/python3.10:/snap/gnome-42-2204-sdk/current/usr/lib/python3/dist-packages:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gobject-introspection${PYTHONPATH:+:$PYTHONPATH}
    build-snaps: [ gnome-42-2204-sdk ]

  gnome-shell:
    after: [ meson-deps, libmutter, gcr ]
    source: https://salsa.debian.org/gnome-team/gnome-shell.git
    source-tag: 'ubuntu/45.0-1ubuntu1'
    plugin: meson
    meson-parameters:
      - --prefix=/usr
      - -Doptimization=3
      - -Ddebug=true
      - -Dtests=false
    build-environment:
      - PATH: /snap/gnome-42-2204-sdk/current/usr/bin${PATH:+:$PATH}
      - XDG_DATA_DIRS: $SNAPCRAFT_STAGE/usr/share:/snap/gnome-42-2204-sdk/current/usr/share:/usr/share${XDG_DATA_DIRS:+:$XDG_DATA_DIRS}
      - LD_LIBRARY_PATH: /snap/gnome-42-2204-sdk/current/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET:/snap/gnome-42-2204-sdk/current/usr/lib:/snap/gnome-42-2204-sdk/current/usr/lib/vala-current:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pulseaudio${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}
      - PKG_CONFIG_PATH: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/lib/pkgconfig:/snap/gnome-42-2204-sdk/current/usr/share/pkgconfig${PKG_CONFIG_PATH:+:$PKG_CONFIG_PATH}
      - GETTEXTDATADIRS: /snap/gnome-42-2204-sdk/current/usr/share/gettext-current${GETTEXTDATADIRS:+:$GETTEXTDATADIRS}
      - GDK_PIXBUF_MODULE_FILE: /snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gdk-pixbuf-current/loaders.cache
      - ACLOCAL_PATH: /snap/gnome-42-2204-sdk/current/usr/share/aclocal${ACLOCAL_PATH:+:$ACLOCAL_PATH}
      - PYTHONPATH: /snap/gnome-42-2204-sdk/current/usr/lib/python3.10:/snap/gnome-42-2204-sdk/current/usr/lib/python3/dist-packages:/snap/gnome-42-2204-sdk/current/usr/lib/$CRAFT_ARCH_TRIPLET/gobject-introspection${PYTHONPATH:+:$PYTHONPATH}
      - CFLAGS: -Wno-error=redundant-decls -Wno-error=format-nonliteral -Wno-error=nonnull
    build-snaps: [ gnome-42-2204-sdk ]
    build-packages:
      - libecal2.0-dev
      - libpolkit-agent-1-dev
      - libibus-1.0-dev
      - libnm-dev
      - libgnome-autoar-0-dev
      - quilt
    override-pull: |
      craftctl default
      QUILT_PATCHES=debian/patches quilt push -a
